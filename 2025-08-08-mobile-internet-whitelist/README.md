# Анализ схемы «CAPTCHA + DPI + Белый список» в мобильных и фиксированных сетях связи

Хотя изначально схема внедряется в мобильных операторах, аналогичные подходы и последствия возможны и в фиксированных (проводных, оптоволоконных, корпоративных) сетях, что затрагивает весь интернет-доступ в стране.

[Источник: «В России разработали техническую схему доступа к массовым сервисам при ограничениях», Интерфакс](https://www.interfax.ru/russia/1040184)

---

## Введение
Схема «CAPTCHA + DPI + Белый список» — это способ управления доступом к интернету при ограничениях.  
**Цель, заявленная официально:** обеспечить доступ к "важным" сервисам (банки, госуслуги, доставка) даже при блокировках.  
**Реальность:** технические уязвимости, возможность обхода и серьёзное падение качества интернета.

---

## ⚠️ Деградация сети и барьеры для импортозамещения

Многоуровневые DPI, whitelisting и обязательная авторизация создают постоянную дополнительную задержку и точку отказа, снижают пропускную способность, увеличивают стоимость эксплуатации сети для операторов, а также сильно ограничивают гибкость модернизации инфраструктуры.

- Зависимость от зарубежных поставщиков оборудования DPI и систем фильтрации, что противоречит целям импортозамещения.
- Сложности интеграции с отечественным ПО и оборудованием, так как протоколы DPI и captive portal часто являются проприетарными.
- Рост расходов на сопровождение и модернизацию, что отнимает ресурсы у развития сети и внедрения новых технологий (5G, edge computing).
- Замедление инноваций в телеком-отрасли и снижение конкурентоспособности российских решений на мировом рынке.

В долгосрочной перспективе эти ограничения ведут к технологической отсталости и снижению киберустойчивости.

---

## 1. Вектор атаки меняется, но не исчезает

**Как это устроено:**  
- При входе в сеть для некоторых SIM-карт (например, иностранных) вводится задержка («охлаждение») и требование пройти CAPTCHA.
- Исключения: корпоративные каналы (APN/MPLS), устройства M2M (банкоматы, терминалы).

**Уязвимости:**

1. **Whitelisted сервисы как транспорт (основной вектор):** шифрованные соединения (TLS/QUIC) и функционал больших платформ (CDN, маркетплейсы, такси) позволяют передавать данные внутри разрешённого трафика (JSON/медиа/WebSocket/edge-функции).

2. **Внешние (offshore) выходы:** прокси/серверы за пределами юрисдикции и сетей российских операторов не подпадают под локальные политики whitelisting/капчи.

3. **Приватные корпоративные APN/L3VPN:** при иной политике на уровне оператора (мягче, без общего whitelisting) позволяют клиентам обходить розничные ограничения. Не универсально — зависит от настроек.

4. **Перепроданные розничные SIM:** используются как «чужие руки» для доступа без персональных ограничений; палятся по поведенческим признакам и могут быть отключены.

- **M2M/IoT-профили:** часто вынесены в исключения ради непрерывности банкоматов/терминалов; полезно лишь там, где доступ не жёстко сегментирован к конкретным узлам.

- **Вывод:** ограничения легко обойти, сохраняя каналы для атак (DDoS, управление ботнетами или дронами).

- **Атаки через whitelisted каналы:** мультиплексирование gRPC/HTTP2 позволяет скрывать командные и управляющие данные внутри разрешённого трафика, усложняя фильтрацию и обнаружение.

---

## 2. «Белый список» — это дырявый фильтр

**Что это:** список разрешённых доменов и сервисов.

**Уязвимости:**
- **TLS/QUIC**: трафик зашифрован, DPI видит только домен (SNI), но не данные.
- **CDN**: один разрешённый CDN-домен = тысячи путей для передачи данных.
- **DoH/DoT**: DNS-запросы можно прятать внутри разрешённых доменов.
- **Семантическое туннелирование**: передача данных внутри картинок, видео, текстов.
- **Использование стеганографии и push-уведомлений:** данные могут передаваться скрыто внутри мультимедийного контента или через механизмы push-уведомлений, что позволяет обходить фильтры и DPI.

**Пример:** ботнет получает команды через поле «комментарий» в разрешённом сервисе такси.

---

## 3. CAPTCHA — контроль, а не защита

**Что это:** в данном контексте «CAPTCHA» — это название механизма блокировки и разблокировки доступа через авторизационную страницу (*captive portal*), а не обязательно классическая визуальная капча.

**Уязвимости:**
- Возможность автоматизации прохождения проверки с помощью современных ML-моделей и публичных API провайдеров CAPTCHA.
- Повторное использование сессий и токенов, что снижает эффективность контроля.
- Обход через привилегированные сервисные аккаунты и интеграции, которые по дизайну обходят капчу.
- При известном протоколе взаимодействия с порталом процесс прохождения проверки может быть полностью автоматизирован.

**Вывод:** защита слаба против автоматизированных систем.

---

## 4. Последствия для пользователей и бизнеса

**Как это выглядит на практике для «одобренного» бизнеса:**
- На словах всё просто — тебе говорят, что раз твой бизнес в белом списке, ты будешь работать без проблем. 

- На деле путь выглядит иначе: сначала кажется, что всё работает, потом разработчики не могут сделать релиз из-за недоступности Git или CI/CD, затем отваливаются зависимые API и сторонние библиотеки, а в видеозвонках появляются задержки и обрывы. Даже если твои сервисы в списке, они зависят от других, которые туда не попали, и каждый день приносит новые непредсказуемые сбои. Это как если бы у тебя был пропуск для проезда по городу, но на каждом перекрёстке кто-то решал бы, пустить ли тебя дальше, и иногда просто забывал, что пропуск у тебя есть.

- Кроме того, малый бизнес в IT-секторе сталкивается с дополнительной проблемой отставания из-за невозможности позволить себе или получить доступ к отечественным программным решениям взамен импортных. Эти компании испытывают двойной вызов: импортные инструменты и облачные сервисы становятся ограниченными или нестабильными, в то время как отечественные «импортозамещающие» решения часто слишком дороги, несовместимы или не обладают необходимым функционалом. В результате возникает технологический разрыв, который снижает их конкурентоспособность, ограничивает инновации и может привести к исключению из ключевых рынков.

**Отдельно стоит отметить стартапы, которые, в отличие от крупных игроков, более чувствительны к выбору технологической платформы. Они не будут использовать навязываемые сервисы по нескольким причинам:**
- Недоверие к безопасности данных и конфиденциальности.
- Опасения о внедрении скрытых инструментов слежки или цензуры.
- Ограниченный функционал и плохая интеграция с современными международными технологическими экосистемами.
- Репутационные риски на внешних рынках при использовании инструментов с политически мотивированным происхождением.

## ⚠️ В результате такие компании либо будут искать пути сохранения доступа к привычным зарубежным сервисам, либо выносить ключевую инфраструктуру за пределы страны, что ещё больше снижает внутреннюю технологическую независимость.

**Технические эффекты:**
- Увеличение задержек (пинг +50–200 мс).
- Джиттер — нестабильная задержка пакетов.
- Падение скорости загрузки из-за понижения протоколов (HTTP/3 → HTTP/1.1).
- Ошибки загрузки из-за неполного белого списка.
- Недоступность Git, CI/CD, облачных IDE, если они вне белого списка.
- Срывы релизов, простои.
- Проблемы с VoIP, VPN и онлайн-конференциями.

---

## 5. Почему это не защищает от дронов и DDoS

**Дроны:**
- Используют спутниковые каналы, радиолинии, автономные сценарии.

**DDoS:**
- Отражается на периметре: scrubbing-центры, Anycast, фильтрация у провайдеров.
- Массовое ограничение пользователей не уменьшает бот-трафик.

---


## 📉 Ключевая проблема

Интернет в XXI веке — стратегическая инфраструктура.  
Эта схема:
- Не решает заявленные задачи безопасности.
- Ухудшает качество связи.
- Создаёт предпосылки для полного контроля и сегментации Рунета.
- Ведёт к превращению мобильного интернета в медленный и нестабильный канал, что снижает эффективность экономики, госуправления и коммуникаций.