# Анализ схемы «CAPTCHA + DPI + Белый список» в мобильных сетях

[Источник: «В России разработали техническую схему доступа к массовым сервисам при ограничениях», Интерфакс](https://www.interfax.ru/russia/1040184)

---

## 1. Вектор атаки меняется, но не исчезает
- **Обход через "мёртвые души"** — SIM-карты, оформленные на людей, которые не используют их сами, можно физически передавать для доступа без ограничений.
- **SIM уехавших россиян** — абоненты, находящиеся за границей, могут предоставлять VPN/прокси-каналы обратно в РФ.
- **Корпоративные каналы (APN/MPLS)** — корпоративные SIM часто выведены в отдельный контур, на них нет розничного whitelisting/DPI.
- **M2M-устройства** — чтобы не отключались банкоматы, POS-терминалы, умные счётчики, эти каналы выносят в исключения. Их можно использовать как транспорт.
- **Легитимные каналы для атак** — командные серверы (C2) можно прятать в разрешённых сервисах: API маркетплейсов, WebSocket чатов в приложениях такси.

**Пример обхода:** подмена JSON-поля `order_comment` в API такси на закодированные команды, которые декодируются у атакующего.

---

## 2. «Белый список» = дырявый фильтр
- **Семантическое туннелирование** — передача данных внутри разрешённых объектов (изображения, видео, метаданные EXIF).
- **CDN** — разрешая домен CDN, оператор впускает тысячи URI, часть которых можно использовать для обхода.
- **DoH/DoT внутри домена** — использование DNS over HTTPS через whitelisted домен (например, встроенный в приложение).
- **Edge-вычисления** — выполнение JavaScript/Worker на краю CDN для переадресации или обфускации трафика.
- **Шардирование** — крупные сервисы динамически создают поддомены, что усложняет ведение белого списка.

**Пример обхода:** загрузка zip-архива, зашифрованного под видом `.png`, на CDN маркетплейса с последующей загрузкой с другого конца.

---

## 3. CAPTCHA как форма авторизации
- **Captive portal** — редирект на страницу проверки, выдача токена доступа (cookie/JWT), занесение IMSI в "разрешённые".
- **Автоматизация** — ML-решатели (например, на базе OCR+ML) или ручное разгадывание с последующим переиспользованием токена.
- **Легитимные сервисные боты** — часто обходят капчу, так как используют привилегированные API-ключи.
- **Цена жёсткой капчи** — рост ложных отказов и падение UX.

**Пример обхода:** автоматическое извлечение капчи через headless-браузер и отправка на сервис типа 2Captcha для мгновенного решения.

---

## 4. Реальные последствия для граждан
- **Рост задержек** — дополнительные DPI и прокси увеличивают пинг на 50–200 мс.
- **Проблемы с HTTP/3/QUIC** — часто понижают соединения до HTTP/1.1, ломая быстрые протоколы.
- **Фальшблоки** — из-за неполного списка разрешённых доменов ломаются веб-приложения.
- **MTU/MSS** — DPI может неверно обрабатывать фрагментацию пакетов, вызывая таймауты.
- **Недоступность рабочих сервисов** — частные GitLab, Jira, облачные IDE.

**Пример обхода:** разработчики в регионах теряют доступ к GitHub Actions, если тот не в белом списке, и вынуждены синхронизироваться через зеркала.

---

## 5. Нулевая ценность в борьбе с дронами и DDoS
- **Дроны** — используют спутниковые каналы, частные радиолинии, автономные миссии, M2M-сети.
- **DDoS** — отражается на периметре через scrubbing-центры, Anycast, ACL, а не через массовое ограничение пользователей.
- **Ботнеты** — могут получать команды через комментарии или медиа в разрешённых сервисах.

**Пример обхода:** ботнет получает инструкции из комментариев к товарам на маркетплейсе, который в whitelist.

---

# Возможные мотивы внедрения

## 1. Централизация управления трафиком
- Один флаг в PCRF/PCF переводит миллионы абонентов в «ограниченный режим».
- Готовые DPI-сценарии и белые списки.

## 2. Тотальная идентификация
- SIM + паспорт + device fingerprint → полная увязка личности и активности.
- Логи запросов к whitelisted сервисам.

## 3. Политический инструмент
- Ограничение коммуникационных сервисов в периоды протестов.
- Тонкая настройка по регионам.

## 4. Финансовая выгода
- Продажа «полного интернета» через одобренные VPN/прокси.
- Снижение нагрузки на сеть.

## 5. Подготовка к изоляции Рунета
- Привычка пользователей к частичной блокировке.
- Основа для будущих госшлюзов.